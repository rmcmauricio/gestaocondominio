<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="alert alert-danger border-0 shadow-sm mb-4" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                <div class="d-flex align-items-center">
                    <div class="me-3">
                        <i class="bi bi-shield-check" style="font-size: 2.5rem;"></i>
                    </div>
                    <div>
                        <h4 class="mb-1" style="color: white;">Bem-vindo, {{ user.name }}!</h4>
                        <p class="mb-0" style="color: rgba(255, 255, 255, 0.9);">Está a visualizar o painel de Super Administrador.</p>
                    </div>
                </div>
            </div>
            
            <h1 class="mb-4">Painel Super Administrador</h1>
            
            {% if pending_transfers and pending_transfers|length > 0 %}
            <div class="alert alert-warning alert-dismissible fade show" role="alert">
                <div class="d-flex align-items-center">
                    <i class="bi bi-exclamation-triangle fs-4 me-3"></i>
                    <div class="flex-grow-1">
                        <strong>Tem {{ pending_transfers|length }} convite(s) pendente(s) para administração de condomínios.</strong>
                        <br>
                        <small>Por favor, aceite ou rejeite os convites para continuar.</small>
                    </div>
                    <a href="{{ BASE_URL }}admin-transfers/pending" class="btn btn-warning btn-sm ms-3">
                        <i class="bi bi-eye"></i> Ver Convites
                    </a>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endif %}
            
            {% if admin_condominiums and admin_condominiums|length > 0 %}
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-shield-check"></i> Condomínios que Geres</h5>
                </div>
                <div class="card-body">
                    <div class="row g-4">
                        {% for condominium in admin_condominiums %}
                        <div class="col-md-6 col-lg-4">
                            <a href="{{ BASE_URL }}condominiums/switch/{{ condominium.id }}" class="text-decoration-none">
                                <div class="card h-100 shadow-sm card-hover border-primary">
                                    {% if condominium.logo_url %}
                                    <div style="width: 100%; height: 150px; overflow: hidden; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa;">
                                        <img src="{{ condominium.logo_url }}" alt="{{ condominium.name }}" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                    </div>
                                    {% endif %}
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">{{ condominium.name }}</h5>
                                            <span class="badge bg-primary">Admin</span>
                                        </div>
                                        <p class="card-text text-muted">
                                            <i class="bi bi-geo-alt"></i> {{ condominium.city }}{% if condominium.district %}, {{ condominium.district }}{% endif %}
                                        </p>
                                        <p class="card-text small text-muted">{{ condominium.address }}</p>
                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                            <span class="badge {% if condominium.is_active %}bg-success{% else %}bg-secondary{% endif %}">
                                                {% if condominium.is_active %}Ativo{% else %}Inativo{% endif %}
                                            </span>
                                            <span class="text-primary">
                                                <i class="bi bi-arrow-right"></i> Gerir
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}

            {% if condomino_condominiums and condomino_condominiums|length > 0 %}
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0"><i class="bi bi-house-door"></i> Condomínios onde és Condómino</h5>
                </div>
                <div class="card-body">
                    <div class="row g-4">
                        {% for condominium in condomino_condominiums %}
                        <div class="col-md-6 col-lg-4">
                            <a href="{{ BASE_URL }}condominiums/switch/{{ condominium.id }}" class="text-decoration-none">
                                <div class="card h-100 shadow-sm card-hover border-info">
                                    {% if condominium.logo_url %}
                                    <div style="width: 100%; height: 150px; overflow: hidden; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa;">
                                        <img src="{{ condominium.logo_url }}" alt="{{ condominium.name }}" style="width: 100%; height: 100%; object-fit: cover; object-position: center;">
                                    </div>
                                    {% endif %}
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">{{ condominium.name }}</h5>
                                            <span class="badge bg-info">Condómino</span>
                                        </div>
                                        <p class="card-text text-muted">
                                            <i class="bi bi-geo-alt"></i> {{ condominium.city }}{% if condominium.district %}, {{ condominium.district }}{% endif %}
                                        </p>
                                        <p class="card-text small text-muted">{{ condominium.address }}</p>
                                        {% if condominium.fraction_identifier %}
                                        <p class="card-text small text-muted mb-2">
                                            <i class="bi bi-house"></i> Fração: {{ condominium.fraction_identifier }}
                                        </p>
                                        {% endif %}
                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                            <span class="badge {% if condominium.is_active %}bg-success{% else %}bg-secondary{% endif %}">
                                                {% if condominium.is_active %}Ativo{% else %}Inativo{% endif %}
                                            </span>
                                            <span class="text-info">
                                                <i class="bi bi-arrow-right"></i> Ver Detalhes
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}
            
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Gestão de Planos</h5>
                            <p class="card-text">Gerir planos e limites do sistema</p>
                            <a href="{{ BASE_URL }}admin/plans" class="btn btn-primary">Gerir Planos</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Utilizadores</h5>
                            <p class="card-text">Gerir contas de administradores</p>
                            <a href="{{ BASE_URL }}admin/users" class="btn btn-primary">Gerir Utilizadores</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Monitorização</h5>
                            <p class="card-text">Logs e estatísticas do sistema</p>
                            <a href="{{ BASE_URL }}admin/monitoring" class="btn btn-primary">Ver Monitorização</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Métodos de Pagamento</h5>
                            <p class="card-text">Ativar ou desativar métodos de pagamento</p>
                            <a href="{{ BASE_URL }}admin/payment-methods" class="btn btn-primary">Gerir Métodos</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Subscrições</h5>
                            <p class="card-text">Gerir e ativar subscrições manualmente</p>
                            <a href="{{ BASE_URL }}admin/subscriptions" class="btn btn-primary">Ver Subscrições</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Condomínios</h5>
                            <p class="card-text">Visualizar condomínios por administrador</p>
                            <a href="{{ BASE_URL }}admin/condominiums" class="btn btn-primary">Ver Condomínios</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Pagamentos</h5>
                            <p class="card-text">Consultar pagamentos das subscrições</p>
                            <a href="{{ BASE_URL }}admin/payments" class="btn btn-primary">Ver Pagamentos</a>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Logs de Auditoria</h5>
                            <p class="card-text">Visualizar registos de auditoria do sistema</p>
                            <a href="{{ BASE_URL }}admin/audit-logs" class="btn btn-primary">Ver Logs</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Logs PHP</h5>
                            <p class="card-text">Visualizar e pesquisar logs de erro do PHP</p>
                            <a href="{{ BASE_URL }}admin/php-logs" class="btn btn-primary">Ver Logs PHP</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-4 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5><i class="bi bi-graph-up"></i> Estatísticas Gerais</h5>
                </div>
                <div class="card-body">
                    <h6 class="mb-3 text-muted"><i class="bi bi-people"></i> Utilizadores e Subscrições</h6>
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">{{ stats.total_users|default(0) }}</h3>
                                <p class="text-muted mb-0">Utilizadores</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-success mb-1">{{ stats.active_subscriptions|default(0) }}</h3>
                                <p class="text-muted mb-0">Subscrições Ativas</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-warning mb-1">{{ stats.suspended_subscriptions|default(0) }}</h3>
                                <p class="text-muted mb-0">Subscrições Suspensas</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.pending_subscriptions|default(0) }}</h3>
                                <p class="text-muted mb-0">Subscrições Pendentes</p>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mb-3 text-muted"><i class="bi bi-building"></i> Condomínios e Frações</h6>
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.total_condominiums|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Condomínios</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-success mb-1">{{ stats.active_condominiums|default(0) }}</h3>
                                <p class="text-muted mb-0">Condomínios Ativos</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">{{ stats.total_fractions|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Frações</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-secondary mb-1">{{ stats.total_residents|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Residentes</p>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mb-3 text-muted"><i class="bi bi-currency-euro"></i> Pagamentos e Receitas</h6>
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-success mb-1">€{{ stats.total_revenue|default(0)|number_format(2, ',', '.') }}</h3>
                                <p class="text-muted mb-0">Receita Total</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">€{{ stats.revenue_this_month|default(0)|number_format(2, ',', '.') }}</h3>
                                <p class="text-muted mb-0">Receita Este Mês</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">€{{ stats.revenue_last_month|default(0)|number_format(2, ',', '.') }}</h3>
                                <p class="text-muted mb-0">Receita Mês Anterior</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-success mb-1">{{ stats.total_payments|default(0) }}</h3>
                                <p class="text-muted mb-0">Pagamentos Completos</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-warning mb-1">{{ stats.pending_payments|default(0) }}</h3>
                                <p class="text-muted mb-0">Pagamentos Pendentes</p>
                                {% if stats.pending_payments_amount|default(0) > 0 %}
                                <small class="text-muted">€{{ stats.pending_payments_amount|number_format(2, ',', '.') }}</small>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-danger mb-1">{{ stats.failed_payments|default(0) }}</h3>
                                <p class="text-muted mb-0">Pagamentos Falhados</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.total_plans|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Planos</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-warning mb-1">{{ stats.pending_fees|default(0) }}</h3>
                                <p class="text-muted mb-0">Quotas Pendentes</p>
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mb-3 text-muted"><i class="bi bi-clipboard-data"></i> Atividades e Conteúdo</h6>
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">{{ stats.total_occurrences|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Ocorrências</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-warning mb-1">{{ stats.open_occurrences|default(0) }}</h3>
                                <p class="text-muted mb-0">Ocorrências Abertas</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.total_assemblies|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Assembleias</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-secondary mb-1">{{ stats.total_documents|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Documentos</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">{{ stats.total_messages|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Mensagens</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.total_notifications|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Notificações</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-success mb-1">{{ stats.total_suppliers|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Fornecedores</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-secondary mb-1">{{ stats.total_reservations|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Reservas</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-info mb-1">{{ stats.total_budgets|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Orçamentos</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-primary mb-1">{{ stats.total_fees|default(0) }}</h3>
                                <p class="text-muted mb-0">Total Quotas</p>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="text-center p-3 bg-light rounded">
                                <h3 class="text-secondary mb-1">{{ stats.total_audit_logs|default(0) }}</h3>
                                <p class="text-muted mb-0">Logs de Auditoria</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>





