<header id="header" class="header {% if viewName == 'pages/home.html.twig' or 'pages/legal/' in viewName %}header-homepage{% endif %}">
  <div class="container">
    <a href="{{ BASE_URL }}" class="logo">
      <img src="{{ BASE_URL }}assets/images/logo.svg" alt="O Meu PrÃ©dio" class="logo-img">
    </a>

    <div class="header-actions">
      {% if user %}
      <!-- Demo Profile Selector -->
      {% if is_demo_user %}
      <div class="demo-profile-selector">
        <div class="dropdown">
          <button class="btn btn-outline-secondary btn-sm demo-profile-btn" type="button" id="demoProfileDropdown" aria-expanded="false" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="bi bi-person-badge"></i>
            <span class="demo-profile-label">
              {% if demo_profile == 'admin' %}
                Admin
              {% else %}
                CondÃ³mino
              {% endif %}
            </span>
            <i class="bi bi-chevron-down ms-1"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end demo-profile-menu" aria-labelledby="demoProfileDropdown">
            <li>
              <a class="dropdown-item {% if demo_profile == 'admin' %}active{% endif %}" href="{{ BASE_URL }}demo/switch-profile?profile=admin">
                <i class="bi bi-shield-check text-primary"></i>
                <span>Admin</span>
                {% if demo_profile == 'admin' %}
                  <i class="bi bi-check-lg ms-auto text-success"></i>
                {% endif %}
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a class="dropdown-item {% if demo_profile == 'condomino' %}active{% endif %}" href="{{ BASE_URL }}demo/switch-profile?profile=condomino">
                <i class="bi bi-person text-info"></i>
                <span>CondÃ³mino</span>
                {% if demo_profile == 'condomino' %}
                  <i class="bi bi-check-lg ms-auto text-success"></i>
                {% endif %}
              </a>
            </li>
          </ul>
        </div>
      </div>
      {% endif %}
      
      <!-- Messages button -->
      {% if condominium %}
      <a href="{{ BASE_URL }}condominiums/{{ condominium.id }}/messages" class="btn btn-outline-primary position-relative sidebar-toggle-header" aria-label="Mensagens" title="Mensagens" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; padding: 0;">
        <i class="bi bi-envelope"></i>
        {% if unread_messages_count > 0 %}
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.65rem;">
            {{ unread_messages_count }}
            <span class="visually-hidden">mensagens nÃ£o lidas</span>
          </span>
        {% endif %}
      </a>
      {% endif %}
      
      <!-- Notifications button -->
      <a href="{{ BASE_URL }}notifications" class="btn btn-outline-primary position-relative sidebar-toggle-header" aria-label="NotificaÃ§Ãµes" title="NotificaÃ§Ãµes" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; padding: 0;">
        <i class="bi bi-bell"></i>
        {% if unread_notifications_count > 0 %}
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.65rem;">
            {{ unread_notifications_count }}
            <span class="visually-hidden">notificaÃ§Ãµes nÃ£o lidas</span>
          </span>
        {% endif %}
      </a>
      <!-- Sidebar toggle button for logged in users -->
      <button class="btn btn-primary sidebar-toggle-header" onclick="toggleSidebar(); return false;" aria-label="Abrir menu" title="Abrir menu">
        <i class="bi bi-list"></i>
      </button>
      {% else %}
      {% if viewName == 'pages/home.html.twig' or 'pages/legal/' in viewName %}
      <!-- Homepage Navigation -->
      <div class="d-flex align-items-center gap-2">
        <a href="{{ BASE_URL }}login" class="btn-login">Entrar</a>
        <a href="{{ BASE_URL }}register" class="btn-start-free">ComeÃ§ar GrÃ¡tis</a>
      </div>
      {% else %}
      <button class="mobile-nav-toggle" aria-label="Toggle navigation" id="mobileNavToggle">
        <i class="bi bi-list"></i>
      </button>

      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="{{ BASE_URL }}">InÃ­cio</a></li>
          <li><a href="{{ BASE_URL }}register" class="btn btn-outline-primary btn-sm">Criar Conta</a></li>
          <li><a href="{{ BASE_URL }}login">Login</a></li>
          <li class="language-selector">
            <div class="dropdown">
              <button class="btn-language" type="button" id="languageDropdown" aria-expanded="false">
                <i class="bi bi-globe"></i>
                <span class="lang-code">{{ current_lang|default('pt')|upper }}</span>
              </button>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown" style="display: none !important; opacity: 0; visibility: hidden;">
                <li>
                  <a class="dropdown-item {% if (current_lang|default('pt')) == 'pt' %}active{% endif %}" href="{{ BASE_URL }}lang/pt">
                    <span class="flag-icon">ðŸ‡µðŸ‡¹</span> PortuguÃªs
                  </a>
                </li>
                <li>
                  <a class="dropdown-item {% if (current_lang|default('pt')) == 'en' %}active{% endif %}" href="{{ BASE_URL }}lang/en">
                    <span class="flag-icon">ðŸ‡¬ðŸ‡§</span> English
                  </a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </nav>
      {% endif %}
      {% endif %}
    </div>
  </div>
</header>
