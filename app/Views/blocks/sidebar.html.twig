{% if user %}
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h5 class="mb-0">Menu</h5>
    </div>
    <nav class="sidebar-nav">
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}">
                    <i class="bi bi-house"></i> Início
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}dashboard">
                    <i class="bi bi-speedometer2"></i> Dashboard
                </a>
            </li>
            
            {% if condominium %}
            <li class="nav-section">
                {% if user_condominiums|length > 1 %}
                <div class="dropdown" style="position: relative; width: 100%;">
                    <button class="btn btn-link nav-section-title dropdown-toggle w-100 text-start text-decoration-none p-0" 
                            type="button" 
                            id="condominiumDropdown" 
                            data-bs-toggle="dropdown" 
                            data-bs-auto-close="true"
                            aria-expanded="false"
                            style="color: inherit; border: none; background: none;">
                        {% set maxLength = 20 %}
                        {% if condominium.name|length > maxLength %}
                            {{ condominium.name|slice(0, maxLength) }}...
                        {% else %}
                            {{ condominium.name }}
                        {% endif %}
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="condominiumDropdown" style="max-width: calc(var(--sidebar-width) - 2rem); width: calc(var(--sidebar-width) - 2rem);">
                        {% for condo in user_condominiums %}
                        <li>
                            <a class="dropdown-item {% if condo.id == condominium.id %}active{% endif %}" 
                               href="{{ BASE_URL }}condominiums/switch/{{ condo.id }}">
                                {{ condo.name }}
                                {% if condo.id == condominium.id %}
                                <i class="bi bi-check float-end"></i>
                                {% endif %}
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% else %}
                <span class="nav-section-title">{{ condominium.name }}</span>
                {% endif %}
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}">
                    <i class="bi bi-info-circle"></i> Visão Geral
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/fractions">
                    <i class="bi bi-house-door"></i> Frações
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/finances">
                    <i class="bi bi-cash-coin"></i> Finanças
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/fees">
                    <i class="bi bi-receipt"></i> Quotas
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}{% if user.role == 'admin' or user.role == 'super_admin' %}condominiums/{{ condominium.id }}/receipts{% else %}receipts{% endif %}">
                    <i class="bi bi-receipt-cutoff"></i> Recibos
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/documents">
                    <i class="bi bi-file-earmark"></i> Documentos
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/occurrences">
                    <i class="bi bi-exclamation-triangle"></i> Ocorrências
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/assemblies">
                    <i class="bi bi-people"></i> Assembleias
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/spaces">
                    <i class="bi bi-building"></i> Espaços
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/reservations">
                    <i class="bi bi-calendar-check"></i> Reservas
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/suppliers">
                    <i class="bi bi-truck"></i> Fornecedores
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}condominiums/{{ condominium.id }}/messages">
                    <i class="bi bi-envelope"></i> Mensagens
                </a>
            </li>
            {% endif %}
            
            {% if user.role == 'admin' or user.role == 'super_admin' %}
            <li class="nav-section">
                <span class="nav-section-title">Sistema</span>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}subscription">
                    <i class="bi bi-credit-card"></i> Subscrição
                </a>
            </li>
            
            {% if user.role == 'super_admin' %}
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}api-keys">
                    <i class="bi bi-key"></i> API Keys
                </a>
            </li>
            {% endif %}
            {% endif %}
            
            <li class="nav-section">
                <span class="nav-section-title">Geral</span>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}notifications">
                    <i class="bi bi-bell"></i> Notificações
                    {% if unread_notifications_count > 0 %}
                        <span class="badge bg-danger ms-auto">{{ unread_notifications_count }}</span>
                    {% endif %}
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}profile">
                    <i class="bi bi-person-circle"></i> Meu Perfil
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="{{ BASE_URL }}help">
                    <i class="bi bi-question-circle"></i> Ajuda
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link text-danger" href="{{ BASE_URL }}logout">
                    <i class="bi bi-box-arrow-right"></i> Sair
                </a>
            </li>
        </ul>
    </nav>
</div>
{% endif %}

